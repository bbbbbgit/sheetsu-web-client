function read(e,t,s){var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){r.readyState>3&&200==r.status&&s(JSON.parse(r.responseText))},r.open("GET",sheetsuUrlGet(e,t),!0),r.send()}function write(e,t,s,r){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.onreadystatechange=function(){n.readyState>3&&201==n.status&&r(JSON.parse(n.responseText))},n.open("POST",sheetsuUrlPost(e,s),!0),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.send(JSON.stringify(t))}Sheetsu={read:read,write:write,version:"1.0"};var sheetsuUrlGet=function(e,t){var s=sheetsuUrl(e),r="",n=addLimitOffsetTransposed(t);return t.sheet&&(r+=sheet(t)),t.search&&(r+=search(t)),""!=n&&(t.search?r+="&"+n:r+="?"+n),s+r},sheetsuUrlPost=function(e,t){var s=sheetsuUrl(e),r="";return t.sheet&&(r+=sheet(t)),s+r},sheetsuUrl=function(e){return e.startsWith("https://sheetsu.com/apis/v1.0/")?e:"https://sheetsu.com/apis/v1.0/"+e},search=function(e){var t=[],s=e.search;for(key in s)t.push(key+"="+s[key]);return"/search?"+t.join("&")},sheet=function(e){return"/sheets/"+e.sheet},addLimitOffsetTransposed=function(e){var t=[];return e.limit&&t.push("limit="+e.limit),e.offset&&t.push("offset="+e.offset),e.transposed&&t.push("transposed="+e.transposed),t.join("&")};String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t});