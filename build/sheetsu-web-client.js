function read(e,t,s){var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){r.readyState>3&&200==r.status&&s(JSON.parse(r.responseText))},r.open("GET",sheetsuUrlGet(e,t),!0),r.send()}function write(e,t,s,r,n){var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.onreadystatechange=function(){i.readyState>3&&201==i.status?r(JSON.parse(i.responseText)):void 0!=n&&n(i.responseText)},i.open("POST",sheetsuUrlPost(e,s),!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.send(JSON.stringify(t))}Sheetsu={read:read,write:write,version:"1.0"};var sheetsuUrlGet=function(e,t){var s=sheetsuUrl(e),r="",n=addLimitOffsetTransposed(t);return t.sheet&&(r+=sheet(t)),t.search&&(r+=search(t)),""!=n&&(r+=t.search?"&"+n:"?"+n),s+r},sheetsuUrlPost=function(e,t){var s=sheetsuUrl(e),r="";return t.sheet&&(r+=sheet(t)),s+r},sheetsuUrl=function(e){return e.startsWith("https://sheetsu.com/apis/v1.0/")?e:"https://sheetsu.com/apis/v1.0/"+e},search=function(e){var t=[],s=e.search;for(key in s)t.push(key+"="+s[key]);return"/search?"+t.join("&")},sheet=function(e){return"/sheets/"+e.sheet},addLimitOffsetTransposed=function(e){var t=[];return e.limit&&t.push("limit="+e.limit),e.offset&&t.push("offset="+e.offset),e.transposed&&t.push("transposed="+e.transposed),e.ignore_case&&t.push("ignore_case="+e.ignore_case),t.join("&")};String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t});