function read(e,t,s){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.onreadystatechange=function(){n.readyState>3&&200==n.status&&s(JSON.parse(n.responseText))},n.open("GET",sheetsuUrlGet(e,t),!0),n.send()}function readWithPromise(e,t){return new Promise(function(s,n){var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.open("GET",sheetsuUrlGet(e,t),!0),r.onload=function(){4===r.readyState&&s(r.responseText)},r.setRequestHeader("Accept","application/vnd.sheetsu.3+json"),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("X-User-Agent","Sheetsu-JS"),r.onerror=function(e){n(e)},console.log("wywołuję"),r.send()})}function write(e,t,s,n){var r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){r.readyState>3&&201==r.status&&n(JSON.parse(r.responseText))},r.open("POST",sheetsuUrlPost(e,s),!0),r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.send(JSON.stringify(t))}Sheetsu={read:function(){return 2==arguments.length?readWithPromise.apply(null,arguments):read.apply(null,arguments)},write:write,version:"1.0"};var sheetsuUrlGet=function(e,t){var s=sheetsuUrl(e),n="",r=addLimitOffsetTransposed(t);return t.sheet&&(n+=sheet(t)),t.search&&(n+=search(t)),""!=r&&(t.search?n+="&"+r:n+="?"+r),s+n},sheetsuUrlPost=function(e,t){var s=sheetsuUrl(e),n="";return t.sheet&&(n+=sheet(t)),s+n},sheetsuUrl=function(e){return e.startsWith("https://sheetsu.com/apis/v1.0/")?e:"https://sheetsu.com/apis/v1.0/"+e},search=function(e){var t=[],s=e.search;for(key in s)t.push(key+"="+s[key]);return"/search?"+t.join("&")},sheet=function(e){return"/sheets/"+e.sheet},addLimitOffsetTransposed=function(e){var t=[];return e.limit&&t.push("limit="+e.limit),e.offset&&t.push("offset="+e.offset),e.transposed&&t.push("transposed="+e.transposed),e.ignore_case&&t.push("ignore_case="+e.ignore_case),t.join("&")};String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t});